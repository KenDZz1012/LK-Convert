<!DOCTYPE html>
<html
  lang="en"
  class="light-style layout-menu-fixed"
  dir="ltr"
  data-theme="theme-default"
  data-assets-path="../assets/"
  data-template="vertical-menu-template-free"
>
  <head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <%-include("../components/head.ejs") %>
  </head>
</head>
<body>
    <div class="layout-wrapper layout-content-navbar">
        <div class="layout-container">
          <!-- Menu -->
  
          <%-include("../components/navbar.ejs") %>
          <div class="layout-page">
            <!-- Navbar -->
  
            <%-include("../components/header.ejs") %>

  
            <!-- / Navbar -->
  
            <!-- Content wrapper -->
            <div class="content-wrapper">
              <!-- Content -->
  
              <div class="container-xxl flex-grow-1 container-p-y">
                <h4 class="fw-bold py-3 mb-4">Create New Account</h4>
                <form method="post"  onsubmit="return post()" enctype="multipart/form-data">
                <div class="row">
                  <div class="col-md-12">
                    <div class="card row" style="height:600px">
                        <div style="display:flex">
                            <h5 class="card-header col-lg-5">Create new</h5>
                            <div id="succes" class="form-text" style="color:rgb(117,171,85);font-size:20px">
                              </div>
                        </div>
                     
                      <div style="display: flex">
                        <div class="card-body col-lg-6">
                            <div class="form-floating">
                              <input
                                name = "username"
                                type="text"
                                class="form-control"
                                id="username"
                                placeholder="Name"
                                aria-describedby="floatingInputHelp"
                              />
                              <label for="floatingInput">Họ và tên</label>
                              <div id="errorUsername" class="form-text" style="color:red;margin-left:5px">
                            </div>
                            </div>
    
                            
                        </div>
                        <div class="card-body col-lg-6">
                            <div class="form-floating">
                              <input
                                name = "email"
                                type="email"
                                class="form-control"
                                id="email"
                                placeholder="email"
                                aria-describedby="floatingInputHelp"
                              />
                              <label for="floatingInput">Email</label>
                              <div id="errorEmail" class="form-text" style="color:red;margin-left:5px">
                              </div>
                            </div>
    
                          </div>
                      </div>




                      <div style="display: flex">
                        <div class="card-body col-lg-6">
                            <div class="form-floating">
                              <input
                                name = "password"
                                type="password"
                                class="form-control"
                                id="password"
                                placeholder="password"
                                aria-describedby="floatingInputHelp"
                              />
                              <label for="floatingInput">Password</label>
                              <div id="errorPass" class="form-text" style="color:red;margin-left:5px">
                              </div>
                            </div>
    
                            
                        </div>
                        <div class="card-body col-lg-6">
                            <div class="form-floating">
                              <input
                                name = "birth"
                                type="date"
                                class="form-control"
                                id="birth"
                                placeholder="John Doe"
                                aria-describedby="floatingInputHelp"
                              />
                              <label for="floatingInput">Date</label>
    
                            </div>
    
                          </div>
                      </div>

                      <div style="display: flex">
                        <div class="card-body col-lg-6">
                            <div class="form-floating">
                              <input
                                name = "avatar"
                                type="file"
                                class="form-control"
                                id="avatar"
                                placeholder="John Doe"
                                aria-describedby="floatingInputHelp"
                                onchange=readURL(this)
                              />
                              <label for="floatingInput">Avatar</label>
    
                            </div>
    
                            
                        </div>
                      </div>
                      <div style="display: flex">

                        <div class="card-body col-lg-6">
                            <img id="uploadImg"  alt="" style="width:100px;height:140px">
                        </div> 
                      </div>
                      <div>
                        
                      </div>
                        <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLongTitle"></h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                                </div>
                                <div class="modal-body">
                                Tạo mới thành công
                                </div>
                                <div class="modal-footer">
                                <button style="background:rgb(117,171,85);color:#fff" type="button" class="btn btn-primary" data-dismiss="modal">Lưu thay đổi</button>
                                </div>
                            </div>
                            </div>
                        </div>
                        <button id="showModal" style="display:none !important;" type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalCenter">
                            Launch demo modal
                          </button>
                      <button id="btnSubmit" type="submit" style="width: 160px;height:50px;border:none;background: #696cff;color:#fff;margin-left:1040px;margin-top:-70px">Create New</button>
                    </div>
                  </div>
  
                </div>
                </form>
              </div>

  
              <div class="content-backdrop fade"></div>
            </div>
            <!-- Content wrapper -->
          </div>
        </div>
    </div>
    <%-include("../components/footer.ejs") %>

</body>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
    async function post(){
        event.preventDefault();
        const username = document.getElementById("username").value
        const password = document.getElementById("password").value
        const birth = document.getElementById("birth").value
        const email = document.getElementById("email").value
        const avatar = document.querySelector("#avatar").files[0]
        console.log(typeof birth)
        if(password.length<6){
            document.getElementById("errorPass").innerHTML = "Password must be at least 6 characters"
            setTimeout(function() {
                document.getElementById("errorPass").innerHTML = ""
            },3000)
            return false;
        }
        else if(username.length<3){
            document.getElementById("errorUsername").innerHTML = "Username must be at least 3 characters"
            setTimeout(function() {
                document.getElementById("errorUsername").innerHTML = ""
            },3000)
            return false;
        }
        else{
            const form = document.querySelector("form");
            const formData = new FormData(form);

            const data = await axios.post(`/admin/account/createAccount`,formData,{
                headers: {
                    "Content-Type": "multipart/form-data",
                },
            })
            console.log(data)
            console.log(data.data.status)
            if(data.data.msg != 'Create Succes'){
                document.getElementById("errorEmail").innerHTML = data.data.msg
                setTimeout(function() {
                    document.getElementById("errorEmail").innerHTML = ""
                },3000)
                
                return false;
            }
            else{
              
                document.getElementById("showModal").click()

            }
        }
    }
    function readURL(input) {
        var reader = new FileReader();
            reader.onload = function (e) {   
                document.getElementById("uploadImg").setAttribute("src",e.target.result)
        }
        reader.readAsDataURL(input.files[0]);
    }
</script>
</html>